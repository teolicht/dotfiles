#!/usr/bin/env bash
set -e
set -u
set -o pipefail

if hash nvim 2>/dev/null; then
  cmd=nvim
elif hash vim 2>/dev/null; then
  cmd=vim
else
  exit 1
fi

XDG_CONFIG_HOME=${XDG_CONFIG_HOME:-$HOME/.config}
plug_vim_path="$XDG_CONFIG_HOME/nvim/autoload/plug.vim"
if [[ ! -f "$plug_vim_path" ]]; then
  curl 'https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim' \
    --fail \
    --location \
    --output "$plug_vim_path" \
    --create-dirs
fi

"$cmd" -e +PlugInstall +PlugUpgrade +PlugUpdate +PlugClean! +qall
